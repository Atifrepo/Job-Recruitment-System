{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _typeof2 = require('babel-runtime/helpers/typeof');\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _simpleAssign = require('simple-assign');\n\nvar _simpleAssign2 = _interopRequireDefault(_simpleAssign);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _Checkbox = require('../Checkbox');\n\nvar _Checkbox2 = _interopRequireDefault(_Checkbox);\n\nvar _TableRowColumn = require('./TableRowColumn');\n\nvar _TableRowColumn2 = _interopRequireDefault(_TableRowColumn);\n\nvar _ClickAwayListener = require('../internal/ClickAwayListener');\n\nvar _ClickAwayListener2 = _interopRequireDefault(_ClickAwayListener);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar TableBody = function (_Component) {\n  (0, _inherits3.default)(TableBody, _Component);\n\n  function TableBody() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, TableBody);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = TableBody.__proto__ || (0, _getPrototypeOf2.default)(TableBody)).call.apply(_ref, [this].concat(args))), _this), _this.state = {\n      selectedRows: []\n    }, _this.isControlled = false, _this.handleClickAway = function () {\n      if (_this.props.deselectOnClickaway && _this.state.selectedRows.length > 0) {\n        var selectedRows = [];\n\n        _this.setState({\n          selectedRows: selectedRows\n        });\n\n        if (_this.props.onRowSelection) {\n          _this.props.onRowSelection(selectedRows);\n        }\n      }\n    }, _this.onRowClick = function (event, rowNumber) {\n      event.stopPropagation();\n\n      if (_this.props.selectable) {\n        // Prevent text selection while selecting rows.\n        if (window.getSelection().rangeCount > 0 && window.getSelection().getRangeAt(0).getClientRects.length > 0) {\n          window.getSelection().removeAllRanges();\n        }\n\n        _this.processRowSelection(event, rowNumber);\n      }\n    }, _this.onCellClick = function (event, rowNumber, columnNumber) {\n      event.stopPropagation();\n\n      if (_this.props.onCellClick) {\n        _this.props.onCellClick(rowNumber, _this.getColumnId(columnNumber), event);\n      }\n    }, _this.onCellHover = function (event, rowNumber, columnNumber) {\n      if (_this.props.onCellHover) {\n        _this.props.onCellHover(rowNumber, _this.getColumnId(columnNumber), event);\n      }\n\n      _this.onRowHover(event, rowNumber);\n    }, _this.onCellHoverExit = function (event, rowNumber, columnNumber) {\n      if (_this.props.onCellHoverExit) {\n        _this.props.onCellHoverExit(rowNumber, _this.getColumnId(columnNumber), event);\n      }\n\n      _this.onRowHoverExit(event, rowNumber);\n    }, _this.onRowHover = function (event, rowNumber) {\n      if (_this.props.onRowHover) {\n        _this.props.onRowHover(rowNumber);\n      }\n    }, _this.onRowHoverExit = function (event, rowNumber) {\n      if (_this.props.onRowHoverExit) {\n        _this.props.onRowHoverExit(rowNumber);\n      }\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  (0, _createClass3.default)(TableBody, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      if (this.props.preScanRows) {\n        this.setState({\n          selectedRows: this.getSelectedRows(this.props)\n        });\n      }\n    }\n  }, {\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      if (!this.props.preScanRows) {\n        this.setState({\n          // eslint-disable-line react/no-did-mount-set-state\n          selectedRows: this.getSelectedRows(this.props)\n        });\n      }\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.allRowsSelected !== nextProps.allRowsSelected) {\n        if (!nextProps.allRowsSelected) {\n          this.setState({\n            selectedRows: []\n          });\n          return;\n        }\n      }\n\n      this.setState({\n        selectedRows: this.getSelectedRows(nextProps)\n      });\n    }\n  }, {\n    key: 'createRows',\n    value: function createRows() {\n      var _this2 = this;\n\n      var numChildren = _react2.default.Children.count(this.props.children);\n\n      var rowNumber = 0;\n      var handlers = {\n        onCellClick: this.onCellClick,\n        onCellHover: this.onCellHover,\n        onCellHoverExit: this.onCellHoverExit,\n        onRowHover: this.onRowHover,\n        onRowHoverExit: this.onRowHoverExit,\n        onRowClick: this.onRowClick\n      };\n      return _react2.default.Children.map(this.props.children, function (child) {\n        if (_react2.default.isValidElement(child)) {\n          var props = {\n            hoverable: _this2.props.showRowHover,\n            selected: _this2.isRowSelected(rowNumber),\n            striped: _this2.props.stripedRows && rowNumber % 2 === 0,\n            rowNumber: rowNumber++\n          };\n\n          if (rowNumber === numChildren) {\n            props.displayBorder = false;\n          }\n\n          var children = [_this2.createRowCheckboxColumn(props)];\n\n          _react2.default.Children.forEach(child.props.children, function (child) {\n            children.push(child);\n          });\n\n          return _react2.default.cloneElement(child, (0, _extends3.default)({}, props, handlers), children);\n        }\n      });\n    }\n  }, {\n    key: 'createRowCheckboxColumn',\n    value: function createRowCheckboxColumn(rowProps) {\n      if (!this.props.displayRowCheckbox) {\n        return null;\n      }\n\n      var name = rowProps.rowNumber + '-cb';\n      var disabled = !this.props.selectable;\n      return _react2.default.createElement(_TableRowColumn2.default, {\n        key: name,\n        columnNumber: 0,\n        style: {\n          width: 24,\n          cursor: disabled ? 'default' : 'inherit'\n        }\n      }, _react2.default.createElement(_Checkbox2.default, {\n        name: name,\n        value: 'selected',\n        disabled: disabled,\n        checked: rowProps.selected\n      }));\n    }\n  }, {\n    key: 'getSelectedRows',\n    value: function getSelectedRows(props) {\n      var _this3 = this;\n\n      var selectedRows = [];\n\n      if (props.selectable) {\n        var index = 0;\n\n        _react2.default.Children.forEach(props.children, function (child) {\n          if (_react2.default.isValidElement(child)) {\n            if (child.props.selected !== undefined) {\n              _this3.isControlled = true;\n            }\n\n            if (child.props.selected && (selectedRows.length === 0 || props.multiSelectable)) {\n              selectedRows.push(index);\n            }\n\n            index++;\n          }\n        });\n      }\n\n      return selectedRows;\n    }\n  }, {\n    key: 'isRowSelected',\n    value: function isRowSelected(rowNumber) {\n      var _this4 = this;\n\n      if (this.props.allRowsSelected) {\n        return true;\n      }\n\n      return this.state.selectedRows.some(function (row) {\n        if ((typeof row === 'undefined' ? 'undefined' : (0, _typeof3.default)(row)) === 'object') {\n          if (_this4.isValueInRange(rowNumber, row)) {\n            return true;\n          }\n        } else {\n          if (row === rowNumber) {\n            return true;\n          }\n        }\n\n        return false;\n      });\n    }\n  }, {\n    key: 'isValueInRange',\n    value: function isValueInRange(value, range) {\n      if (!range) return false;\n\n      if (range.start <= value && value <= range.end || range.end <= value && value <= range.start) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: 'processRowSelection',\n    value: function processRowSelection(event, rowNumber) {\n      var selectedRows = [].concat((0, _toConsumableArray3.default)(this.state.selectedRows));\n\n      if (event.shiftKey && this.props.multiSelectable && selectedRows.length > 0) {\n        var lastIndex = selectedRows.length - 1;\n        var lastSelection = selectedRows[lastIndex];\n\n        if ((typeof lastSelection === 'undefined' ? 'undefined' : (0, _typeof3.default)(lastSelection)) === 'object') {\n          lastSelection.end = rowNumber;\n        } else {\n          selectedRows.splice(lastIndex, 1, {\n            start: lastSelection,\n            end: rowNumber\n          });\n        }\n      } else if ((event.ctrlKey && !event.metaKey || event.metaKey && !event.ctrlKey) && this.props.multiSelectable) {\n        var idx = selectedRows.indexOf(rowNumber);\n\n        if (idx < 0) {\n          var foundRange = false;\n\n          for (var i = 0; i < selectedRows.length; i++) {\n            var range = selectedRows[i];\n            if ((typeof range === 'undefined' ? 'undefined' : (0, _typeof3.default)(range)) !== 'object') continue;\n\n            if (this.isValueInRange(rowNumber, range)) {\n              var _selectedRows;\n\n              foundRange = true;\n              var values = this.splitRange(range, rowNumber);\n\n              (_selectedRows = selectedRows).splice.apply(_selectedRows, [i, 1].concat((0, _toConsumableArray3.default)(values)));\n            }\n          }\n\n          if (!foundRange) selectedRows.push(rowNumber);\n        } else {\n          selectedRows.splice(idx, 1);\n        }\n      } else {\n        if (selectedRows.length === 1 && selectedRows[0] === rowNumber) {\n          selectedRows = [];\n        } else {\n          selectedRows = [rowNumber];\n        }\n      }\n\n      if (!this.isControlled) {\n        this.setState({\n          selectedRows: selectedRows\n        });\n      }\n\n      if (this.props.onRowSelection) {\n        this.props.onRowSelection(this.flattenRanges(selectedRows));\n      }\n    }\n  }, {\n    key: 'splitRange',\n    value: function splitRange(range, splitPoint) {\n      var splitValues = [];\n      var startOffset = range.start - splitPoint;\n      var endOffset = range.end - splitPoint; // Process start half\n\n      splitValues.push.apply(splitValues, (0, _toConsumableArray3.default)(this.genRangeOfValues(splitPoint, startOffset))); // Process end half\n\n      splitValues.push.apply(splitValues, (0, _toConsumableArray3.default)(this.genRangeOfValues(splitPoint, endOffset)));\n      return splitValues;\n    }\n  }, {\n    key: 'genRangeOfValues',\n    value: function genRangeOfValues(start, offset) {\n      var values = [];\n      var dir = offset > 0 ? -1 : 1; // This forces offset to approach 0 from either direction.\n\n      while (offset !== 0) {\n        values.push(start + offset);\n        offset += dir;\n      }\n\n      return values;\n    }\n  }, {\n    key: 'flattenRanges',\n    value: function flattenRanges(selectedRows) {\n      var _this5 = this;\n\n      return selectedRows.reduce(function (rows, row) {\n        if ((typeof row === 'undefined' ? 'undefined' : (0, _typeof3.default)(row)) === 'object') {\n          var values = _this5.genRangeOfValues(row.end, row.start - row.end);\n\n          rows.push.apply(rows, [row.end].concat((0, _toConsumableArray3.default)(values)));\n        } else {\n          rows.push(row);\n        }\n\n        return rows;\n      }, []).sort();\n    }\n  }, {\n    key: 'getColumnId',\n    value: function getColumnId(columnNumber) {\n      return columnNumber - 1;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          style = _props.style,\n          allRowsSelected = _props.allRowsSelected,\n          multiSelectable = _props.multiSelectable,\n          onCellClick = _props.onCellClick,\n          onCellHover = _props.onCellHover,\n          onCellHoverExit = _props.onCellHoverExit,\n          onRowHover = _props.onRowHover,\n          onRowHoverExit = _props.onRowHoverExit,\n          onRowSelection = _props.onRowSelection,\n          selectable = _props.selectable,\n          deselectOnClickaway = _props.deselectOnClickaway,\n          showRowHover = _props.showRowHover,\n          stripedRows = _props.stripedRows,\n          displayRowCheckbox = _props.displayRowCheckbox,\n          preScanRows = _props.preScanRows,\n          other = (0, _objectWithoutProperties3.default)(_props, ['style', 'allRowsSelected', 'multiSelectable', 'onCellClick', 'onCellHover', 'onCellHoverExit', 'onRowHover', 'onRowHoverExit', 'onRowSelection', 'selectable', 'deselectOnClickaway', 'showRowHover', 'stripedRows', 'displayRowCheckbox', 'preScanRows']);\n      var prepareStyles = this.context.muiTheme.prepareStyles;\n      return _react2.default.createElement(_ClickAwayListener2.default, {\n        onClickAway: this.handleClickAway\n      }, _react2.default.createElement('tbody', (0, _extends3.default)({\n        style: prepareStyles((0, _simpleAssign2.default)({}, style))\n      }, other), this.createRows()));\n    }\n  }]);\n  return TableBody;\n}(_react.Component);\n\nTableBody.muiName = 'TableBody';\nTableBody.defaultProps = {\n  allRowsSelected: false,\n  deselectOnClickaway: true,\n  displayRowCheckbox: true,\n  multiSelectable: false,\n  preScanRows: true,\n  selectable: true,\n  style: {}\n};\nTableBody.contextTypes = {\n  muiTheme: _propTypes2.default.object.isRequired\n};\nTableBody.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /**\n   * @ignore\n   * Set to true to indicate that all rows should be selected.\n   */\n  allRowsSelected: _propTypes2.default.bool,\n\n  /**\n   * Children passed to table body.\n   */\n  children: _propTypes2.default.node,\n\n  /**\n   * The css class name of the root element.\n   */\n  className: _propTypes2.default.string,\n\n  /**\n   * Controls whether or not to deselect all selected\n   * rows after clicking outside the table.\n   */\n  deselectOnClickaway: _propTypes2.default.bool,\n\n  /**\n   * Controls the display of the row checkbox. The default value is true.\n   */\n  displayRowCheckbox: _propTypes2.default.bool,\n\n  /**\n   * @ignore\n   * If true, multiple table rows can be selected.\n   * CTRL/CMD+Click and SHIFT+Click are valid actions.\n   * The default value is false.\n   */\n  multiSelectable: _propTypes2.default.bool,\n\n  /**\n   * @ignore\n   * Callback function for when a cell is clicked.\n   */\n  onCellClick: _propTypes2.default.func,\n\n  /**\n   * @ignore\n   * Called when a table cell is hovered. rowNumber\n   * is the row number of the hovered row and columnId\n   * is the column number or the column key of the cell.\n   */\n  onCellHover: _propTypes2.default.func,\n\n  /**\n   * @ignore\n   * Called when a table cell is no longer hovered.\n   * rowNumber is the row number of the row and columnId\n   * is the column number or the column key of the cell.\n   */\n  onCellHoverExit: _propTypes2.default.func,\n\n  /**\n   * @ignore\n   * Called when a table row is hovered.\n   * rowNumber is the row number of the hovered row.\n   */\n  onRowHover: _propTypes2.default.func,\n\n  /**\n   * @ignore\n   * Called when a table row is no longer\n   * hovered. rowNumber is the row number of the row\n   * that is no longer hovered.\n   */\n  onRowHoverExit: _propTypes2.default.func,\n\n  /**\n   * @ignore\n   * Called when a row is selected. selectedRows is an\n   * array of all row selections. If all rows have been selected,\n   * the string \"all\" will be returned instead to indicate that\n   * all rows have been selected.\n   */\n  onRowSelection: _propTypes2.default.func,\n\n  /**\n   * Controls whether or not the rows are pre-scanned to determine\n   * initial state. If your table has a large number of rows and\n   * you are experiencing a delay in rendering, turn off this property.\n   */\n  preScanRows: _propTypes2.default.bool,\n\n  /**\n   * @ignore\n   * If true, table rows can be selected. If multiple\n   * row selection is desired, enable multiSelectable.\n   * The default value is true.\n   */\n  selectable: _propTypes2.default.bool,\n\n  /**\n   * If true, table rows will be highlighted when\n   * the cursor is hovering over the row. The default\n   * value is false.\n   */\n  showRowHover: _propTypes2.default.bool,\n\n  /**\n   * If true, every other table row starting\n   * with the first row will be striped. The default value is false.\n   */\n  stripedRows: _propTypes2.default.bool,\n\n  /**\n   * Override the inline-styles of the root element.\n   */\n  style: _propTypes2.default.object\n} : {};\nexports.default = TableBody;","map":null,"metadata":{},"sourceType":"script"}